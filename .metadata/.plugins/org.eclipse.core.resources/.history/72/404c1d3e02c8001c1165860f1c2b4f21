package karnataka.servicio;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

import karnataka.db.Conexion;
import karnataka.entidades.Vista;

public class EvaluacionService {


	public  static ArrayList<Vista> buscarPorEmpresayFecha(int codEmpresa, int anio, int mes) {
		String sql = "SELECT * FROM REP_VENTA_DETAL_COL_PRUE_VW rvdcpv WHERE CON_COD_EMPRESA = " + codEmpresa
				+ "AND CON_ANIO = "+anio+" AND CON_MES ="+mes;
		Connection con = Conexion.connect();
		Vista vista;
		ArrayList<Vista> lista = new ArrayList<Vista>();
		if (con != null) {
			try {
				PreparedStatement st = con.prepareCall(sql);
				ResultSet rs = st.executeQuery();
				while (rs.next()) {
					vista = new Vista();
					vista.setCodigo(rs.getInt(1));
					vista.setAnio(rs.getInt(2));
					vista.setMes(rs.getInt(3));
					vista.setDia(rs.getInt(4));
					vista.setCod_empresa(rs.getInt(8));
					vista.setNombre_empresa(rs.getString(9));
					lista.add(vista);
				}

			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			} finally {
				try {
					con.close();
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
		}
		return lista;
	}
}
