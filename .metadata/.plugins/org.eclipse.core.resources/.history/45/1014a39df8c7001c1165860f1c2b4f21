package rest.service;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

import rest.db.Conexion;
import rest.entidades.Vista;

public class EvaluacionService {
	
	public Vista buscarPorEmpresa(int codEmpresa){
		String sql = "SELECT * FROM REP_VENTA_DETAL_COL_PRUE_VW rvdcpv WHERE CON_COD_PRODUCTO = "+ codEmpresa;
		Connection con = Conexion.connect();
		Vista vista = new Vista();
		ArrayList<Vista> lista = new ArrayList<Vista>();
		if( con != null){
	        try {
	            PreparedStatement st = con.prepareCall(sql);
	            ResultSet rs = st.executeQuery();
	            while( rs.next()){
	              vista.setCodigo(rs.getInt(1));
	              vista.setAnio(rs.getInt(2));
	              vista.setMes(rs.getInt(3));
	              vista.setDia(rs.getInt(4));
	              vista.setCod_empresa(rs.getInt(8));
	              vista.setNombre_empresa(rs.getString(9));
	              lista.add(vista);
	            }
	           
	        } catch (SQLException e) {
	            // TODO Auto-generated catch block
	            e.printStackTrace();
	        }
	    }
		return vista;
	}

}
